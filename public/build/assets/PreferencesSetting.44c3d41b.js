var U=Object.defineProperty;var V=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var S=(m,l,t)=>l in m?U(m,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[l]=t,B=(m,l)=>{for(var t in l||(l={}))G.call(l,t)&&S(m,t,l[t]);if(V)for(var t of V(l))j.call(l,t)&&S(m,t,l[t]);return m};import{g as N,i as q,j as E,k as y,D as P,m as f,n as _,q as O,r as g,o as T,c as Y,b as s,w as u,y as e,z as Z,v as R,x as A,t as H,a0 as J,B as K}from"./vendor.e9042f2c.js";import{c as L,m as Q}from"./main.c4ed6aa9.js";const W=["onSubmit"],X={class:"divide-y divide-gray-200"},ne={setup(m){const l=L(),t=Q(),{t:p,tm:x}=N();let b=q(!1),i=q(!1);const o=E(B({},l.selectedCompanySettings));y(()=>t.config.retrospective_edits.map(a=>(a.title=p(a.key),a))),P(()=>o.carbon_date_format,a=>{if(a){const r=t.dateFormats.find(c=>c.carbon_format_value===a);o.moment_date_format=r.moment_format_value}});const $=y({get:()=>o.discount_per_item==="YES",set:async a=>{const r=a?"YES":"NO";let c={settings:{discount_per_item:r}};o.discount_per_item=r,await l.updateCompanySettings({data:c,message:"general.setting_updated"})}}),w=y(()=>({currency:{required:f.withMessage(p("validation.required"),_)},language:{required:f.withMessage(p("validation.required"),_)},carbon_date_format:{required:f.withMessage(p("validation.required"),_)},moment_date_format:{required:f.withMessage(p("validation.required"),_)},time_zone:{required:f.withMessage(p("validation.required"),_)},fiscal_year:{required:f.withMessage(p("validation.required"),_)}})),n=O(w,y(()=>o));h();async function h(){i.value=!0,Promise.all([t.fetchCurrencies(),t.fetchDateFormats(),t.fetchTimeZones()]).then(([a])=>{i.value=!1})}async function k(){n.value.$touch(),!n.value.$invalid&&(b.value=!0,await l.updateCompanySettings({data:{settings:B({},o)},message:"settings.preferences.updated_message"}),b.value=!1)}return(a,r)=>{const c=g("BaseMultiselect"),v=g("BaseInputGroup"),I=g("BaseInputGrid"),C=g("BaseIcon"),z=g("BaseButton"),M=g("BaseDivider"),D=g("BaseSwitchSection"),F=g("BaseSettingCard");return T(),Y("form",{action:"",class:"relative",onSubmit:K(k,["prevent"])},[s(F,{title:a.$t("settings.menu_title.preferences"),description:a.$t("settings.preferences.general_settings")},{default:u(()=>[s(I,{class:"mt-5"},{default:u(()=>[s(v,{"content-loading":e(i),label:a.$tc("settings.preferences.currency"),"help-text":a.$t("settings.preferences.company_currency_unchangeable"),error:e(n).currency.$error&&e(n).currency.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(o).currency,"onUpdate:modelValue":r[0]||(r[0]=d=>e(o).currency=d),"content-loading":e(i),options:e(t).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",invalid:e(n).currency.$error,disabled:"",class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","label","help-text","error"]),s(v,{label:a.$tc("settings.preferences.default_language"),"content-loading":e(i),error:e(n).language.$error&&e(n).language.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(o).language,"onUpdate:modelValue":r[1]||(r[1]=d=>e(o).language=d),"content-loading":e(i),options:e(t).config.languages,label:"name","value-prop":"code",class:"w-full","track-by":"code",searchable:!0,invalid:e(n).language.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(v,{label:a.$tc("settings.preferences.time_zone"),"content-loading":e(i),error:e(n).time_zone.$error&&e(n).time_zone.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(o).time_zone,"onUpdate:modelValue":r[2]||(r[2]=d=>e(o).time_zone=d),"content-loading":e(i),options:e(t).timeZones,label:"key","value-prop":"value","track-by":"key",searchable:!0,invalid:e(n).time_zone.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(v,{label:a.$tc("settings.preferences.date_format"),"content-loading":e(i),error:e(n).carbon_date_format.$error&&e(n).carbon_date_format.$errors[0].$message,required:""},{default:u(()=>[s(c,{modelValue:e(o).carbon_date_format,"onUpdate:modelValue":r[3]||(r[3]=d=>e(o).carbon_date_format=d),"content-loading":e(i),options:e(t).dateFormats,label:"display_date","value-prop":"carbon_format_value","track-by":"carbon_format_value",searchable:"",invalid:e(n).carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),s(v,{"content-loading":e(i),error:e(n).fiscal_year.$error&&e(n).fiscal_year.$errors[0].$message,label:a.$tc("settings.preferences.fiscal_year"),required:""},{default:u(()=>[s(c,{modelValue:e(o).fiscal_year,"onUpdate:modelValue":r[4]||(r[4]=d=>e(o).fiscal_year=d),"content-loading":e(i),options:e(t).config.fiscal_years,label:"key","value-prop":"value",invalid:e(n).fiscal_year.$error,"track-by":"key",searchable:!0,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","error","label"])]),_:1}),s(z,{"content-loading":e(i),disabled:e(b),loading:e(b),type:"submit",class:"mt-6"},{left:u(d=>[s(C,{name:"SaveIcon",class:Z(d.class)},null,8,["class"])]),default:u(()=>[R(" "+A(a.$tc("settings.company_info.save")),1)]),_:1},8,["content-loading","disabled","loading"]),s(M,{class:"mt-6 mb-2"}),H("ul",X,[s(D,{modelValue:e($),"onUpdate:modelValue":r[5]||(r[5]=d=>J($)?$.value=d:null),title:a.$t("settings.preferences.discount_per_item"),description:a.$t("settings.preferences.discount_setting_description")},null,8,["modelValue","title","description"])])]),_:1},8,["title","description"])],40,W)}}};export{ne as default};
