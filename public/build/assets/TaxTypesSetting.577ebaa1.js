import{i as R,u as U,q as A,d as N,g as P,e as x,c as H}from"./main.c4ed6aa9.js";import{g as $,u as q,am as Y,r as n,o as m,s as g,w as t,y as s,b as l,v as T,x as B,A as I,i as z,k as M,a5 as j,z as G,c as J,a0 as K}from"./vendor.e9042f2c.js";import{_ as Q}from"./TaxTypeModal.e84ae727.js";const W={props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(S){const o=S,b=R();U();const{t:i}=$(),h=A(),C=q(),_=N(),c=P();Y("utils");async function v(r){await h.fetchTaxType(r),c.openModal({title:i("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:o.loadData&&o.loadData})}function w(r){b.openDialog({title:i("general.are_you_sure"),message:i("settings.tax_types.confirm_delete"),yesLabel:i("general.ok"),noLabel:i("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async d=>{if(d){if((await h.deleteTaxType(r)).data.success)return o.loadData&&o.loadData(),!0;o.loadData&&o.loadData()}})}return(r,d)=>{const p=n("BaseIcon"),E=n("BaseButton"),D=n("BaseDropdownItem"),a=n("BaseDropdown");return m(),g(a,null,{activator:t(()=>[s(C).name==="tax-types.view"?(m(),g(E,{key:0,variant:"primary"},{default:t(()=>[l(p,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(m(),g(p,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:t(()=>[s(_).hasAbilities(s(x).EDIT_TAX_TYPE)?(m(),g(D,{key:0,onClick:d[0]||(d[0]=u=>v(S.row.id))},{default:t(()=>[l(p,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(r.$t("general.edit")),1)]),_:1})):I("",!0),s(_).hasAbilities(s(x).DELETE_TAX_TYPE)?(m(),g(D,{key:1,onClick:d[1]||(d[1]=u=>w(S.row.id))},{default:t(()=>[l(p,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(r.$t("general.delete")),1)]),_:1})):I("",!0)]),_:1})}}},Z={key:0},se={setup(S){const{t:o}=$(),b=Y("utils"),i=H(),h=A(),C=P(),_=N(),c=z(null),v=z(i.selectedCompanySettings.tax_per_item),w=M(()=>[{key:"name",label:o("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"compound_tax",label:o("settings.tax_types.compound_tax"),tdClass:"font-medium text-gray-900"},{key:"percent",label:o("settings.tax_types.percent"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),r=M({get:()=>v.value==="YES",set:async a=>{const u=a?"YES":"NO";let y={settings:{tax_per_item:u}};v.value=u,await i.updateCompanySettings({data:y,message:"general.setting_updated"})}});function d(){return _.hasAbilities([x.DELETE_TAX_TYPE,x.EDIT_TAX_TYPE])}async function p({page:a,filter:u,sort:y}){let k={orderByField:y.fieldName||"created_at",orderBy:y.order||"desc",page:a},f=await h.fetchTaxTypes(k);return{data:f.data.data,pagination:{totalPages:f.data.meta.last_page,currentPage:a,totalCount:f.data.meta.total,limit:5}}}async function E(){c.value&&c.value.refresh()}function D(){C.openModal({title:o("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:c.value&&c.value.refresh})}return(a,u)=>{const y=n("BaseIcon"),k=n("BaseButton"),f=n("BaseBadge"),O=n("BaseTable"),V=n("BaseDivider"),X=n("BaseSwitchSection"),L=n("BaseSettingCard");return m(),g(L,{title:a.$t("settings.tax_types.title"),description:a.$t("settings.tax_types.description")},j({default:t(()=>[l(Q),l(O,{ref:(e,F)=>{F.table=e,c.value=e},class:"mt-16",data:p,columns:s(w)},j({"cell-compound_tax":t(({row:e})=>[l(f,{"bg-color":s(b).getBadgeStatusColor(e.data.compound_tax?"YES":"NO").bgColor,color:s(b).getBadgeStatusColor(e.data.compound_tax?"YES":"NO").color},{default:t(()=>[T(B(e.data.compound_tax?"Yes":"No".replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),"cell-percent":t(({row:e})=>[T(B(e.data.percent)+" % ",1)]),_:2},[d()?{name:"cell-actions",fn:t(({row:e})=>[l(W,{row:e.data,table:c.value,"load-data":E},null,8,["row","table"])])}:void 0]),1032,["columns"]),s(_).currentUser.is_owner?(m(),J("div",Z,[l(V,{class:"mt-8 mb-2"}),l(X,{modelValue:s(r),"onUpdate:modelValue":u[0]||(u[0]=e=>K(r)?r.value=e:null),title:a.$t("settings.tax_types.tax_per_item"),description:a.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","title","description"])])):I("",!0)]),_:2},[s(_).hasAbilities(s(x).CREATE_TAX_TYPE)?{name:"action",fn:t(()=>[l(k,{type:"submit",variant:"primary-outline",onClick:D},{left:t(e=>[l(y,{class:G(e.class),name:"PlusIcon"},null,8,["class"])]),default:t(()=>[T(" "+B(a.$t("settings.tax_types.add_new_tax")),1)]),_:1})])}:void 0]),1032,["title","description"])}}};export{se as default};
